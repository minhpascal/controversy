{% extends "base.html" %}
{% block content %}
{% if form.errors %}
<div id=error>
    {% for field in form.errors %}
    <b>{{ field|safe }}</b>&hellip;
    {% for error in form.errors[field] %}
    {{ error|lower }}
    {% endfor %}
    {% endfor %}
</div>
{% endif %}
{% with messages = get_flashed_messages() %}
{% if messages %}
<div id=message>
    {% for message in messages %}
    {{ message }}
    {% if not loop.last %}
    &middot;
    {% endif %}
    {% endfor %}
</div>
{% endif %}
{% endwith %}
<div id=login>
    <h1>Controversy</h1>
    <span id=details>
	    Please login or <a href="register">create a free account</a>. <a href="training">Annotate articles</a> to help us build a dataset for future study!
	    <center>
		    <a class="github-button" href="https://github.com/gdyer/controversy" data-icon="octicon-star" data-style="mega" aria-label="Star gdyer/controversy on GitHub">Star</a>
		    <a class="github-button" href="https://github.com/gdyer/controversy/issues" data-icon="octicon-issue-opened" data-style="mega" data-count-api="/repos/gdyer/controversy#open_issues_count" data-count-aria-label="# issues on GitHub" aria-label="Issue gdyer/controversy on GitHub">Known bugs</a>
	    </center>
	    <hr>
	    We recommend using the latest version of Chrome, Chromium, or Opera.
    </span>
    <p><noscript><tt>Requires JavaScript</tt></noscript></p>
    <form style="display:none" method=POST>
        {{ form.hidden_tag() }}
        {{ form.email(value=username, type="email", class_="field", placeholder="email (username)", required="required") }}
        {{ form.password(class="field", placeholder="password", required="required") }}
	<center>
        	<input type=submit value="log in" />
	</center>
    </form>
</div>
<script>
if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) {
	window.location.replace('not-supported');
}
document.getElementsByTagName('form')[0].style.display = 'block';
</script>
<script src="{{ url_for('static', filename='lib/jquery.min.js') }}"></script>
<script>
if (!window.jQuery) {
	document.getElementsByTagName('form')[0].style.display = 'none';
} else {
	var isWebKit = 'WebkitAppearance' in document.documentElement.style;
	var isSafari = (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1);
	console.log(isWebKit);
	console.log(isSafari);
	if (isWebKit)
		$.ajax({url: '/set_webkit?webkit=' + 'webkit'});
	if (isSafari)
		$.ajax({url: '/set_safari?safari=' + 'safari'});
}
</script>
<script async defer id="github-bjs" src="//buttons.github.io/buttons.js"></script>
{% endblock %}
